%! TEX program = lualatex
\documentclass[12pt]{article}
\errorcontextlines=100
%\usepackage[paper=a4paper,margin=0.6cm]{geometry}
%\usepackage{luacode}
\usepackage{prettytok}
\ExplSyntaxOn \prettyinit: \ExplSyntaxOff
%\usepackage[abspath]{currfile}
\usepackage{rescansync}
\usepackage{precattl}
\usepackage{filecontentsdef}
\usepackage{genvar}
\usepackage{saveenv}
\AutoGenerateVariants
\begin{document}

content

content


\edef\aalineno{1+\the\inputlineno}
\begin{saveenv}\aa
\ExplSyntaxOff 123
456

789

789
\end{saveenv}

\ExplSyntaxOn

\exp_args:NV \rescansync:nn \aa {\aalineno}


done

done

\ExplSyntaxOff

\begin{rescansyncSaveenvPacked}\aa
	12 3

	45 6

	78 9
\end{rescansyncSaveenvPacked}

\ExplSyntaxOn
\begin{rescansyncRewriteenv}{
	\str_replace_all:Nnn #1 {1} {A}
}
\ExplSyntaxOff
	12 3

	41 6

	78 1
\end{rescansyncRewriteenv}

\rescansyncPacked\aa

\ExplSyntaxOn



\ExplSyntaxOff


\end{document}
