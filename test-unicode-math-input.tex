%! TEX program = pdflatex
\documentclass{article}
\usepackage{amsmath}
%\usepackage{amssymb}
\usepackage{bm}
\usepackage{hyperref}
\usepackage{iftex}
\usepackage{newtxmath}

\newif\ifonehalfPredefined
\onehalfPredefinedtrue
\newif\iftimesPredefined
\timesPredefinedtrue

\ifTUTeX

	\usepackage{fancyvrb}
	\usepackage{fontspec}

\else

	\ifcsname u8:\detokenize{Â½}\endcsname
	\else
		\onehalfPredefinedfalse  % in older LaTeX versions Â½ is not defined in text mode
	\fi

	\ifcsname u8:\detokenize{Ã—}\endcsname
	\else
		\timesPredefinedfalse  % in older LaTeX versions Â½ is not defined in text mode
	\fi

\fi

\tracinglostchars=3

\usepackage{l3benchmark}
\csname benchmark_tic:\endcsname
\usepackage[ignore-patch-prime]{unicode-math-input}
\csname benchmark_toc:\endcsname  % exclude the time to process AtBeginDocument, but because hyperref takes time AtBeginDocument too
\begin{document}


\csname sys_if_engine_pdftex:TF\endcsname{\iftrue}{\iffalse}
\else
\newfontfamily{\mymono}{Liberation Mono}[NFSSFamily=LiberationMono]
\fvset{fontfamily=LiberationMono}

The $Î±$ and $Î²$ must be in mono font instead of math font below:
\begin{Verbatim}
1+Î±=Î²
\end{Verbatim}
\fi

$a\overbrace{a}b$

Type with ASCII gives $a''$ and $a'''''$.

$ğ’œâ„¬ğ’$

\ifdefined\dprime
	$a^{\prime\prime}$ is worse than  $a^{\dprime}$
\fi

$aâ€µ$ is $a^{\backprime}$

$a`$ is not $a^{\backprime}$ without unicode-math

use not:
$\not\leftarrow, x_{\not\leftarrow}$
$\not\exists, x_{\not\exists}$
$\not\equiv, x_{\not\equiv}$
$\not\cong, x_{\not\cong}$

\begin{align*}
	\alpha + \beta &= \gamma \\
	Î± + Î² &= Î³ \\
	Ã— & Â±
\end{align*}

use built-in:
$\nleftarrow, x_{\nleftarrow}$
$\nexists, x_{\nexists}$
%$\nequiv, x_{\nequiv}$
$\ncong, x_{\ncong}$

use unicode characters: $âˆ„ \quad x â‰¢ y \quad âŠ­$

circ: $\circ$ / $â„¤ â„ Â½ âˆ˜ â†š â–¡$

\newcommand\test{123}
\section{a \iftimesPredefined Ã—\fi b = \texorpdfstring{$a Ã— b$}{a \iftimesPredefined Ã—\fi b} Ãœ \"U \test}

$\left\uparrow \frac{1}{2} \right\downarrow$

\expandafter\def\csname u8:â†‘\endcsname{\uparrow}
\expandafter\def\csname u8:â†“\endcsname{\downarrow}

$\Big{â†‘} \frac{1}{2} \Big{â†“}$

\ifonehalfPredefined
a Â½ b
\fi

\[ a = Â½ + {\textstyle \frac{1}{2}} + \frac{3}{4} \]

$G'^{34}$

$G'^\bgroup34\egroup$
\umiPatchPrime
% the definition of TeX is somewhat interesting to make this correct
% (or happens to be correct)

default fraction: \[Â½\]
\let\umiFrac\tfrac
patched fraction: \[Â½\]

%$G^2'$  % cannot work

$GÂ¹Â²Â³â‚„â‚…â‚†$

\[\intÂ¹Â²Â³â‚„â‚…â‚† x\,dx\]

\[âˆ«Â¹Â²Â³â‚„â‚…â‚† x\,dx\]

$GÂ²'$

multiplication: \iftimesPredefined a Ã— b\fi, $a Ã— b$

prime: $aâ€²$, $bâ€³$

bracket: $âŸ¨a+bâŸ©, \leftâŸ¨ \frac{1}{2} \rightâŸ© $


\umiPatchCmdUnicodeTwoArgs \frac
$\frac Î±Î²$
\umiUnpatchCmdUnicodeArg \frac

Big: $\Big\langle 5 \Big\rangle$

\umiUnpatchCmdUnicodeArg \Big

\umiPatchCmdUnicodeArgExtraGroup \Big
Big: $\Big\langle 5 \Big\rangle$

$\Big( \Big) \Big\{ \Big\} \Big< \Big>$

Bigl/r: $\BiglâŸ¨ 5 \BigrâŸ©$

\umiUnpatchCmdUnicodeArg \Big
Bigl/r: $\Bigl\langle 5 \Bigr\rangle$

$âˆš2 + âˆš{23^{45}} + âˆ›{78a}$

Test umiDeclareMathChar (with \# token):
\umiDeclareMathChar {'} {\def\test#1{ab#1ef}\test{cd}}%
\umiDeclareMathChar {â†‘} {\def\test#1{ab#1ef}\test{cd}}%
$'=â†‘$

\tableofcontents


{\setbox0\vbox{
\nonstopmode
\errorcontextlines=10
\umiDeclareMathChar {12} {34}  % if is Unicode engine this will raise error, otherwise it's not checked
\umiDeclareMathChar {&} {34}   % will raise an error
\umiPatchPrime    % error: already patched
\umiUnpatchPrime  % success
\umiUnpatchPrime  % error: not patched
\errorstopmode
}}  % throw away the box to avoid \tracinglostchars giving fatal error


\end{document}
